---
- name: "[ ASDF-VM ]"
  hosts: all

  vars:
    asdf_home: "{{ lookup('env', 'HOME') }}/.asdf"
    asdf_version: 0.18.0
    asdf_checksum: sha256:4d3007070166cb0a652af26c3f0462b021e04cb26c4ab13894d13689da89f5b8
    asdf_target_arch: linux-amd64

  tasks:
    - name: Download asdf binary
      ansible.builtin.get_url:
        url: "https://github.com/asdf-vm/asdf/releases/download/v{{ asdf_version }}/asdf-v{{ asdf_version }}-{{ asdf_target_arch }}.tar.gz"
        checksum: "{{ asdf_checksum }}"
        dest: /tmp/asdf.tar.gz
        mode: "0644"

    - name: Unarchive binary
      ansible.builtin.unarchive:
        src: /tmp/asdf.tar.gz
        dest: "{{ home }}/.local/bin"
        include:
          - asdf
